From becd68ba0dac41904aa817d96a67fb4685734b41 Mon Sep 17 00:00:00 2001
From: dan <dan@noemail.net>
Date: Sat, 16 May 2020 17:26:58 +0000
Subject: [PATCH] Fix a use-after-free bug in the fts3 snippet() function.

FossilOrigin-Name: 0d69f76f0865f9626078bee087a22fb826407279e78cf9d5382e1c985c9f64a9
---
 ext/fts3/fts3.c        |  1 +
 4 files changed, 23 insertions(+), 9 deletions(-)

--- sqlite3-3.27.2.orig/ext/fts3/fts3.c
+++ sqlite3-3.27.2/ext/fts3/fts3.c
@@ -5238,6 +5238,7 @@ static void fts3EvalNextRow(
                 fts3EvalNextRow(pCsr, pLeft, pRc);
               }
             }
+            pRight->bEof = pLeft->bEof = 1;
           }
         }
         break;
